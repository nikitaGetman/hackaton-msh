{"remainingRequest":"/Users/nikitagetman/Desktop/Studying/Хакатоны/MSH er-telecom/node_modules/babel-loader/lib/index.js!/Users/nikitagetman/Desktop/Studying/Хакатоны/MSH er-telecom/node_modules/eslint-loader/index.js??ref--13-0!/Users/nikitagetman/Desktop/Studying/Хакатоны/MSH er-telecom/src/http/interceptors/auth.js","dependencies":[{"path":"/Users/nikitagetman/Desktop/Studying/Хакатоны/MSH er-telecom/src/http/interceptors/auth.js","mtime":1623347625355},{"path":"/Users/nikitagetman/Desktop/Studying/Хакатоны/MSH er-telecom/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nikitagetman/Desktop/Studying/Хакатоны/MSH er-telecom/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nikitagetman/Desktop/Studying/Хакатоны/MSH er-telecom/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gIi9Vc2Vycy9uaWtpdGFnZXRtYW4vRGVza3RvcC9TdHVkeWluZy9cdTA0MjVcdTA0MzBcdTA0M0FcdTA0MzBcdTA0NDJcdTA0M0VcdTA0M0RcdTA0NEIvTVNIIGVyLXRlbGVjb20vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIi9Vc2Vycy9uaWtpdGFnZXRtYW4vRGVza3RvcC9TdHVkeWluZy9cdTA0MjVcdTA0MzBcdTA0M0FcdTA0MzBcdTA0NDJcdTA0M0VcdTA0M0RcdTA0NEIvTVNIIGVyLXRlbGVjb20vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyBmcm9tICIvVXNlcnMvbmlraXRhZ2V0bWFuL0Rlc2t0b3AvU3R1ZHlpbmcvXHUwNDI1XHUwNDMwXHUwNDNBXHUwNDMwXHUwNDQyXHUwNDNFXHUwNDNEXHUwNDRCL01TSCBlci10ZWxlY29tL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RXaXRob3V0UHJvcGVydGllcyI7CmltcG9ydCB7IEFVVEhfSEVBREVSLCBFUlJPUl9TVEFUVVNFUyB9IGZyb20gJ0AvY29uc3RhbnRzL2h0dHAnOwppbXBvcnQgY2xpZW50IGZyb20gJy4uL2NsaWVudCc7CmltcG9ydCBhdXRoU2VydmljZSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9hdXRoJzsKZXhwb3J0IGZ1bmN0aW9uIHJlcXVlc3RXaXRoQXV0aChfcmVmKSB7CiAgdmFyIF9yZWYkX3dpdGhvdXRBdXRoSGVhZCA9IF9yZWYuX3dpdGhvdXRBdXRoSGVhZGVyLAogICAgICBfd2l0aG91dEF1dGhIZWFkZXIgPSBfcmVmJF93aXRob3V0QXV0aEhlYWQgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZiRfd2l0aG91dEF1dGhIZWFkLAogICAgICBjb25maWcgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoX3JlZiwgWyJfd2l0aG91dEF1dGhIZWFkZXIiXSk7CgogIGlmIChfd2l0aG91dEF1dGhIZWFkZXIpIHsKICAgIHJldHVybiBjb25maWc7CiAgfQoKICB2YXIgYWRkaXRpb25hbEhlYWRlcnMgPSBfZGVmaW5lUHJvcGVydHkoe30sIEFVVEhfSEVBREVSLCBhdXRoU2VydmljZS5nZXRBdXRoSGVhZGVyKCkpOwoKICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBjb25maWcpLCB7fSwgewogICAgaGVhZGVyczogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBjb25maWcuaGVhZGVycyksIGFkZGl0aW9uYWxIZWFkZXJzKQogIH0pOwp9CmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVBdXRoRXJyb3IoZXJyb3IpIHsKICB2YXIgZXJyb3JTdGF0dXMgPSBlcnJvci5yZXNwb25zZS5zdGF0dXM7CgogIGlmIChlcnJvclN0YXR1cyA9PT0gRVJST1JfU1RBVFVTRVMuVU5BVVRIT1JJWkVEKSB7CiAgICB2YXIgX3JldHJ5ID0gZXJyb3IuY29uZmlnLl9yZXRyeTsKCiAgICBpZiAoIV9yZXRyeSkgewogICAgICByZXR1cm4gYXV0aFNlcnZpY2UucmVmcmVzaEF1dGhUb2tlbnMoKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gY2xpZW50LnJlcXVlc3QoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBlcnJvci5jb25maWcpLCB7fSwgewogICAgICAgICAgaGVhZGVyczogX29iamVjdFNwcmVhZCh7fSwgZXJyb3IuY29uZmlnLmhlYWRlcnMpLAogICAgICAgICAgX3JldHJ5OiB0cnVlCiAgICAgICAgfSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn0="},{"version":3,"sources":["/Users/nikitagetman/Desktop/Studying/Хакатоны/MSH er-telecom/src/http/interceptors/auth.js"],"names":["AUTH_HEADER","ERROR_STATUSES","client","authService","requestWithAuth","_withoutAuthHeader","config","additionalHeaders","getAuthHeader","headers","handleAuthError","error","errorStatus","response","status","UNAUTHORIZED","_retry","refreshAuthTokens","then","request","Promise","reject"],"mappings":";;;;AAAA,SAASA,WAAT,EAAsBC,cAAtB,QAA4C,kBAA5C;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,WAAP,MAAwB,qBAAxB;AAEA,OAAO,SAASC,eAAT,OAAoE;AAAA,mCAAzCC,kBAAyC;AAAA,MAAzCA,kBAAyC,sCAApB,KAAoB;AAAA,MAAVC,MAAU;;AACzE,MAAID,kBAAJ,EAAwB;AACtB,WAAOC,MAAP;AACD;;AAED,MAAMC,iBAAiB,uBACpBP,WADoB,EACNG,WAAW,CAACK,aAAZ,EADM,CAAvB;;AAIA,yCACKF,MADL;AAEEG,IAAAA,OAAO,kCACFH,MAAM,CAACG,OADL,GAEFF,iBAFE;AAFT;AAOD;AAED,OAAO,SAASG,eAAT,CAAyBC,KAAzB,EAAgC;AACrC,MAAMC,WAAW,GAAGD,KAAK,CAACE,QAAN,CAAeC,MAAnC;;AAEA,MAAIF,WAAW,KAAKX,cAAc,CAACc,YAAnC,EAAiD;AAAA,QACvCC,MADuC,GAC5BL,KAAK,CAACL,MADsB,CACvCU,MADuC;;AAE/C,QAAI,CAACA,MAAL,EAAa;AACX,aAAOb,WAAW,CAACc,iBAAZ,GAAgCC,IAAhC,CAAqC;AAAA,eAC1ChB,MAAM,CAACiB,OAAP,iCACKR,KAAK,CAACL,MADX;AAEEG,UAAAA,OAAO,oBACFE,KAAK,CAACL,MAAN,CAAaG,OADX,CAFT;AAKEO,UAAAA,MAAM,EAAE;AALV,WAD0C;AAAA,OAArC,CAAP;AASD;AACF;;AAED,SAAOI,OAAO,CAACC,MAAR,CAAeV,KAAf,CAAP;AACD","sourcesContent":["import { AUTH_HEADER, ERROR_STATUSES } from '@/constants/http'\nimport client from '../client'\nimport authService from '../../services/auth'\n\nexport function requestWithAuth({ _withoutAuthHeader = false, ...config }) {\n  if (_withoutAuthHeader) {\n    return config\n  }\n\n  const additionalHeaders = {\n    [AUTH_HEADER]: authService.getAuthHeader()\n  }\n\n  return {\n    ...config,\n    headers: {\n      ...config.headers,\n      ...additionalHeaders\n    }\n  }\n}\n\nexport function handleAuthError(error) {\n  const errorStatus = error.response.status\n\n  if (errorStatus === ERROR_STATUSES.UNAUTHORIZED) {\n    const { _retry } = error.config\n    if (!_retry) {\n      return authService.refreshAuthTokens().then(() =>\n        client.request({\n          ...error.config,\n          headers: {\n            ...error.config.headers\n          },\n          _retry: true\n        })\n      )\n    }\n  }\n\n  return Promise.reject(error)\n}\n"]}]}